package com.example.cve202324998.controller;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.util.MultiValueMap;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RequestPart;
import org.springframework.web.multipart.MultipartFile;

import java.util.Arrays;
import java.util.List;
import java.util.Map;

@Slf4j
@Controller
@RequiredArgsConstructor
public class FileUploadController {

    @PostMapping("/fileUpload")
    public ResponseEntity<String> fileUpload(@RequestParam MultiValueMap<String, String> textData, @RequestPart("fileData") MultipartFile[] fileData) {
        // RequestParam 어노테이션을 사용하여 텍스트 데이터를 받습니다.
        // RequestPart 어노테이션을 사용하여 파일 데이터를 받습니다.
        // 파일 데이터는 MultipartFile[] 배열로 받습니다.

        for(MultipartFile file : fileData) {
            // 각 파일에 대한 처리를 수행합니다.
        }

        // 텍스트 데이터와 파일 데이터를 이용한 처리를 수행합니다.
        for (String value : textData.get("textData")) {

        }


        log.info("MultipartFile[] fileData :: {}", Arrays.stream(fileData).count());
        log.info("MultiValueMap<String, String> textData :: {}", textData.get("textData").size());

        return ResponseEntity.ok("success");
    }
}
